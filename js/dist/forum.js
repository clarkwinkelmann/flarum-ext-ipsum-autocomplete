(()=>{var t={n:e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return t.d(r,{a:r}),r},d:(e,r)=>{for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const r=flarum.core.compat["forum/app"];var o=t.n(r);const a=flarum.core.compat["common/extend"],n=flarum.core.compat["common/components/TextEditor"];var i=t.n(n);const s=flarum.core.compat["forum/utils/KeyboardNavigatable"];var p=t.n(s);function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}const u=flarum.core.compat["common/Fragment"];var h=t.n(u);const l=flarum.core.compat["common/components/Button"];var d=t.n(l),f=function(t){var e,r;function a(){for(var e,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).active=!1,e.ipsumInsertStart=0,e.paragraphs=1,e}r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,c(e,r);var n=a.prototype;return n.view=function(){var t=this;return d().component({className:"Button LoremIpsumAutocomplete",onclick:this.apply.bind(this)},o().translator.trans("clarkwinkelmann-ipsum-autocomplete.forum.insert",{input:m("input",{type:"number",min:1,step:1,value:this.paragraphs,onchange:function(e){t.paragraphs=parseInt(e.target.value)},onclick:function(t){t.stopPropagation()}})}))},n.show=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.$().show().css({left:t+"px",top:e+"px"}),this.active=!0},n.hide=function(){this.$().hide(),this.active=!1},n.up=function(){this.paragraphs++,this.refreshInput()},n.down=function(){this.paragraphs=Math.max(this.paragraphs-1,1),this.refreshInput()},n.refreshInput=function(){this.$("input").val(this.paragraphs)},n.apply=function(){var t=this;o().request({url:o().forum.attribute("apiUrl")+"/lorem-ipsum-autocomplete",method:"GET",params:{paragraphs:this.paragraphs}}).then((function(e){o().composer.editor.replaceBeforeCursor(t.ipsumInsertStart,e.text,!1),t.paragraphs=1,t.hide()}))},a}(h());o().initializers.add("clarkwinkelmann-ipsum-autocomplete",(function(){var t=$('<div class="ComposerBody-loremIpsumDropdownContainer"></div>'),e=new f;(0,a.extend)(i().prototype,"oncreate",(function(){var r=this.$(".TextEditor-editor").wrap('<div class="ComposerBody-loremIpsumWrapper"></div>');this.loremIpsumNavigator=new(p()),this.loremIpsumNavigator.when((function(){return e.active})).onUp(e.up.bind(e)).onDown(e.down.bind(e)).onSelect(e.apply.bind(e)).onCancel(e.hide.bind(e)).bindTo(r),r.after(t)})),(0,a.extend)(i().prototype,"buildEditorParams",(function(r){var o=this;r.inputListeners.push((function(){var r=o.attrs.composer.editor.getSelectionRange(),a=r[0];if(!(r[1]-a>0)){var n=o.attrs.composer.editor.getLastNChars(16),i=n.search(/lorem(\s*ipsum)?(\s*[0-9]+)?$/i);if(-1===i&&(i=n.search(/ipsum(\s*[0-9]+)?$/)),e.hide(),-1!==i){var s=/[m\s]([1-9][0-9]*)$/.exec(n);s&&(e.paragraphs=parseInt(s[1])),e.ipsumInsertStart=a-n.length+i,m.render(t[0],e.render()),e.show();var p=o.attrs.composer.editor.getCaretCoordinates(e.ipsumInsertStart),c=e.$().outerWidth(),u=e.$().outerHeight(),h=e.$().offsetParent(),l=p.left,d=p.top+15;d+u>h.height()&&(d=p.top-u-15),l+c>h.width()&&(l=h.width()-c),d=Math.max(-(h.offset().top-$(document).scrollTop()),d),l=Math.max(-h.offset().left,l),e.show(l,d)}}}))}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map